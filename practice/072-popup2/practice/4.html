<style>
    /*插件样式开始*/
    .haru-popup {
        position: fixed;
        z-index: 1000;
        background: #fff;
        padding: 10px;
        border: 4px solid;
        -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, .1);
        -moz-box-shadow: 0 1px 5px rgba(0, 0, 0, .1);
        box-shadow: 0 1px 5px rgba(0, 0, 0, .1);
    }

    .haru-mask {
        position: fixed;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(0, 0, 0, .6);
        z-index: 999;
    }

    [hidden] {
        display: none !important;
    }

    /*插件样式结束*/
</style>

<body>
    <button id="trigger-user">收藏</button>
    <div id="popup-user">
        确定要收藏吗？
        <img src="http://dummyimage.com/200x200">
    </div>

    <div>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facere inventore maiores nam natus necessitatibus
        nihil
        quasi quibusdam sit tempora, vel? Dolores eos est itaque, laborum numquam obcaecati vitae voluptate
        voluptatibus!
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facere inventore maiores nam natus necessitatibus
        nihil
        quasi quibusdam sit tempora, vel? Dolores eos est itaque, laborum numquam obcaecati vitae voluptate
        voluptatibus!
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facere inventore maiores nam natus necessitatibus
        nihil
        quasi quibusdam sit tempora, vel? Dolores eos est itaque, laborum numquam obcaecati vitae voluptate
        voluptatibus!
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facere inventore maiores nam natus necessitatibus
        nihil
        quasi quibusdam sit tempora, vel? Dolores eos est itaque, laborum numquam obcaecati vitae voluptate
        voluptatibus!
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facere inventore maiores nam natus necessitatibus
        nihil
        quasi quibusdam sit tempora, vel? Dolores eos est itaque, laborum numquam obcaecati vitae voluptate
        voluptatibus!
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facere inventore maiores nam natus necessitatibus
        nihil
        quasi quibusdam sit tempora, vel? Dolores eos est itaque, laborum numquam obcaecati vitae voluptate
        voluptatibus!
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facere inventore maiores nam natus necessitatibus
        nihil
        quasi quibusdam sit tempora, vel? Dolores eos est itaque, laborum numquam obcaecati vitae voluptate
        voluptatibus!
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consectetur corporis debitis dolore ducimus eaque ex
        id,
        ipsa itaque modi nisi, odit optio perspiciatis quos recusandae reiciendis tempore vel voluptatem, voluptates.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consectetur corporis debitis dolore ducimus eaque ex
        id,
        ipsa itaque modi nisi, odit optio perspiciatis quos recusandae reiciendis tempore vel voluptatem, voluptates.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consectetur corporis debitis dolore ducimus eaque ex
        id,
        ipsa itaque modi nisi, odit optio perspiciatis quos recusandae reiciendis tempore vel voluptatem, voluptates.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consectetur corporis debitis dolore ducimus eaque ex
        id,
        ipsa itaque modi nisi, odit optio perspiciatis quos recusandae reiciendis tempore vel voluptatem, voluptates.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consectetur corporis debitis dolore ducimus eaque ex
        id,
        ipsa itaque modi nisi, odit optio perspiciatis quos recusandae reiciendis tempore vel voluptatem, voluptates.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consectetur corporis debitis dolore ducimus eaque ex
        id,
        ipsa itaque modi nisi, odit optio perspiciatis quos recusandae reiciendis tempore vel voluptatem, voluptates.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consectetur corporis debitis dolore ducimus eaque ex
        id,
        ipsa itaque modi nisi, odit optio perspiciatis quos recusandae reiciendis tempore vel voluptatem, voluptates.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consectetur corporis debitis dolore ducimus eaque ex
        id,
        ipsa itaque modi nisi, odit optio perspiciatis quos recusandae reiciendis tempore vel voluptatem, voluptates.
        Lorem ipsum dolor sit amet, consectetur adipisicing elit. Consectetur corporis debitis dolore ducimus eaque ex
        id,
        ipsa itaque modi nisi, odit optio perspiciatis quos recusandae reiciendis tempore vel voluptatem, voluptates.
    </div>
    <!--用户HTML结束-->
</body>
<script>
    //定义三个全文变量
    let popup, mask, trigger;

    // 用户定义js开始
    boot('#popup-user', '#trigger-user');
    // 用户定义js结束

    /**
    * 设置必要的弹出层信息
    * @param {string} triggerSelector 点谁弹出（选择器）
    * @param {string} popupSelector 弹出谁（选择器）
    */
    function boot(popupSelector, triggerSelector) {
        popup = document.querySelector(popupSelector);
        trigger = document.querySelector(triggerSelector);
        //准备popup        
        initPopup();
        // 准备遮罩
        initMask();
        // 绑定打开相关事件
        bindOpen();
        // 绑定关闭相关事件
        bindClose();
    }
    // 绑定打开相关事件
    function bindOpen() {
        trigger.addEventListener('click', () => {
            visbility(true);
        })
        repocitionPopup('center',-30);
    }
    // 绑定关闭相关事件
    function bindClose() {
        mask.addEventListener('click', () => {
            visbility(false);
        })
        document.addEventListener('keyup', (e) => {
            if(e.code==='Escape')
                visbility(false);
        })
    }
    // 设置是否可见
    function visbility(show = false) {
        mask.hidden = popup.hidden = !show;
    }

    //准备popup
    // function initPopup() {
    //     popup.hidden = true;
    //     popup.classList.add('haru-popup');
    // }
    function initPopup() {
        // 添加插件专属类，这样就可以和插件自带的CSS接应配合
        popup.classList.add('haru-popup');
        // Popup一开始不应该显示
        popup.hidden = true;
    }
    // 准备遮罩
    function initMask() {
        // 创建一个div，命名为mask
        mask = document.createElement('div');
        // 给mask加类名用来定义插件样式
        mask.classList.add('haru-mask');
        // 把mask追加为body的儿子
        document.body.appendChild(mask);
        // 设置mask的初始状态为hidden
        mask.hidden = true;
    }
    function repocitionPopup(pocition,yOffset){
        
    }
</script>